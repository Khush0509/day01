<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rose Day üåπ</title>

<style>
body{
margin:0;
font-family:'Segoe UI',sans-serif;
text-align:center;
background:linear-gradient(135deg,#ffe4ec,#fff0f5);
overflow:hidden;
}

h1{
color:#ff4d88;
margin-top:20px;
}

canvas{
background:white;
border-radius:20px;
box-shadow:0 0 20px rgba(0,0,0,0.2);
touch-action:none;
}

.toolbar{
margin:15px;
}

button{
padding:10px 18px;
border:none;
border-radius:12px;
background:#ff4d88;
color:white;
margin:5px;
}

input[type=color]{
width:40px;
height:40px;
border:none;
}

/* Popup */
#popup{
position:fixed;
inset:0;
background:rgba(0,0,0,0.5);
display:flex;
justify-content:center;
align-items:center;
opacity:0;
pointer-events:none;
transition:0.5s;
}

.card{
background:rgba(255,255,255,0.6);
backdrop-filter:blur(20px);
padding:25px;
border-radius:25px;
width:85%;
max-width:500px;
}

#message{
font-size:18px;
line-height:1.6;
white-space:pre-wrap;
}

.heart{
position:fixed;
font-size:20px;
animation:float 6s linear infinite;
}

@keyframes float{
from{transform:translateY(0);}
to{transform:translateY(-110vh);}
}

</style>
</head>
<body>

<h1>Draw a Heart to Unlock üåπ</h1>

<canvas id="canvas"></canvas>

<div class="toolbar">
<input type="color" id="colorPicker">
<button onclick="clearCanvas()">Clear</button>
<button onclick="eraser()">Eraser</button>
</div>

<div id="popup">
<div class="card">
<h2>Yayyyy ‚ù§Ô∏è</h2>
<p id="message"></p>
</div>
</div>

<audio id="music" loop>
<source src="rose-music.mp3" type="audio/mpeg">
</audio>

<script>

const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");
const popup=document.getElementById("popup");
const messageBox=document.getElementById("message");
const music=document.getElementById("music");

let drawing=false;
let points=[];
let color="#ff4d88";

/* Resize Canvas */
function resize(){
canvas.width=window.innerWidth*0.9;
canvas.height=window.innerHeight*0.45;
}
resize();
window.addEventListener("resize",resize);

/* Color Picker */
document.getElementById("colorPicker").oninput=e=>{
color=e.target.value;
ctx.globalCompositeOperation="source-over";
}

/* Eraser */
function eraser(){
ctx.globalCompositeOperation="destination-out";
ctx.lineWidth=20;
}

/* Clear */
function clearCanvas(){
ctx.clearRect(0,0,canvas.width,canvas.height);
points=[];
}

/* GET POSITION */
function getPos(e){
const rect=canvas.getBoundingClientRect();

if(e.touches){
return{
x:e.touches[0].clientX-rect.left,
y:e.touches[0].clientY-rect.top
};
}else{
return{
x:e.clientX-rect.left,
y:e.clientY-rect.top
};
}
}

/* START DRAW */
function startDraw(e){
drawing=true;
points=[];

let pos=getPos(e);
ctx.beginPath();
ctx.moveTo(pos.x,pos.y);
}

/* DRAW */
function draw(e){
if(!drawing) return;

let pos=getPos(e);
points.push(pos);

ctx.lineWidth=5;
ctx.lineCap="round";
ctx.strokeStyle=color;

ctx.lineTo(pos.x,pos.y);
ctx.stroke();
}

/* STOP */
function stopDraw(){
drawing=false;

if(checkHeart()){
unlock();
}
}

/* EVENTS */
canvas.addEventListener("mousedown",startDraw);
canvas.addEventListener("mousemove",draw);
canvas.addEventListener("mouseup",stopDraw);
canvas.addEventListener("mouseleave",stopDraw);

canvas.addEventListener("touchstart",startDraw);
canvas.addEventListener("touchmove",draw);
canvas.addEventListener("touchend",stopDraw);

/* HEART DETECTION */
function checkHeart(){

if(points.length<60) return false;

let xs=points.map(p=>p.x);
let ys=points.map(p=>p.y);

let width=Math.max(...xs)-Math.min(...xs);
let height=Math.max(...ys)-Math.min(...ys);

/* heart approx */
return height > width*0.8;
}

/* UNLOCK */
function unlock(){

popup.style.opacity="1";
popup.style.pointerEvents="all";

music.play().catch(()=>{});

confetti();
typeText();
}

/* Confetti */
function confetti(){
setInterval(()=>{
let h=document.createElement("div");
h.className="heart";
h.innerHTML="üåπ";
h.style.left=Math.random()*100+"vw";
document.body.appendChild(h);
},400);
}

/* Typing Text */
const text=`Happy Rose Day Kanishka üåπ

To be honest‚Ä¶
If i had to select A ROSE from the world,
toh mai everytime aapko hi choose karta.

U sirf ek rose nahi ho‚Ä¶
u toh most beautiful, soft aur SINGLE ROSE ho
jo shayad God ne specially meri life ke liye design kiya hai.

Just like rose makes our environment calm,
waise hi aap bhi meri life ko peaceful bana deti ho.

Your smile makes my day better, or even the best.
And when u is happy,
i feel like everything i do for u is perfect.

I may not be able to say this...
but me loves you bhoooot saraaaaa

Thank you meri life mein aane ke liye.
And thank you‚Ä¶ meri hone ke liye ‚ù§Ô∏è`;

let i=0;

function typeText(){
let interval=setInterval(()=>{
messageBox.textContent+=text.charAt(i);
i++;
if(i>=text.length) clearInterval(interval);
},40);
}

</script>
</body>
</html>
